generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["jsonProtocol"]
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id            String   @id @default(uuid())
    name          String?  @db.VarChar(50)
    description   String?  @db.VarChar(160)
    location      String?  @db.VarChar(30)
    website       String?  @db.VarChar(30)
    photoUrl      String?
    headerUrl     String?
    username      String   @unique @db.VarChar(20)
    password      String
    createdAt     DateTime @default(now())
    updatedAt     DateTime @default(now()) @updatedAt
    createdTweets Tweet[]  @relation("userTweets")
    retweets      Tweet[]  @relation("userRetweets")
    likedTweets   Tweet[]  @relation("userLikes")
    following     User[]   @relation("userFollows")
    followers     User[]   @relation("userFollows")
}

model Tweet {
    id          String   @id @default(uuid())
    text        String   @db.VarChar(280)
    createdAt   DateTime @default(now())
    author      User     @relation("userTweets", fields: [authorId], references: [id])
    authorId    String
    photoUrl    String?
    likedBy     User[]   @relation("userLikes")
    retweetedBy User[]   @relation("userRetweets")
    replies     Tweet[]  @relation("tweetReplies")
    retweets    Tweet[]  @relation("retweetOf")
    isRetweet   Boolean  @default(false)
    retweetOf   Tweet?   @relation("retweetOf", fields: [retweetOfId], references: [id])
    retweetOfId String?
    isReply     Boolean  @default(false)
    repliedTo   Tweet?   @relation("tweetReplies", fields: [repliedToId], references: [id])
    repliedToId String?
}
